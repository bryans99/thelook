explore: pdt_example {}

view: pdt_example {
  # Or, you could make this view a derived table, like this:
  derived_table: {
    sql: SELECT '2015-10-12' as orders_created_week, '239' as orders_count, 'NULL' as four_week_order_growth, '14175' as events_count, '4385' as events_sessions_count, 'NULL' as four_week_event_growth, 'NULL' as four_week_session_growth UNION ALL
      SELECT '2015-10-19', '226', 'NULL', '14209', '4358', 'NULL', 'NULL' UNION ALL
      SELECT '2015-10-26', '224', 'NULL', '13067', '4213', 'NULL', 'NULL' UNION ALL
      SELECT '2015-11-02', '231', 'NULL', '13706', '4344', 'NULL', 'NULL' UNION ALL
      SELECT '2015-11-09', '209', '-0.125523012552301', '13266', '4222', '-0.32063492063492', '-0.185860889395667' UNION ALL
      SELECT '2015-11-16', '223', '-0.0132743362831858', '13704', '4352', '-0.177704271940319', '-0.00688389169343717' UNION ALL
      SELECT '2015-11-23', '209', '-0.0669642857142857', '13495', '4264', '0.16377133236397', '0.0605269404225017' UNION ALL
      SELECT '2015-11-30', '242', '0.0476190476190476', '13919', '4350', '0.0777031956807239', '0.00690607734806669' UNION ALL
      SELECT '2015-12-07', '251', '0.200956937799043', '13946', '4375', '0.256294286145032', '0.181193747039317' UNION ALL
      SELECT '2015-12-14', '231', '0.0358744394618835', '14286', '4480', '0.212346760070052', '0.147058823529411' UNION ALL
      SELECT '2015-12-21', '258', '0.23444976076555', '13925', '4443', '0.159318266024452', '0.209896810506566' UNION ALL
      SELECT '2015-12-28', '222', '-0.0826446280991735', '13436', '4379', '-0.17350384366693', '0.0333333333333329' UNION ALL
      SELECT '2016-01-04', '256', '0.0199203187250995', '14292', '4512', '0.124049906783306', '0.156571428571428' UNION ALL
      SELECT '2016-01-11', '242', '0.0476190476190476', '14082', '4506', '-0.0713985720285592', '0.0290178571428567' UNION ALL
      SELECT '2016-01-18', '271', '0.0503875968992248', '14285', '4518', '0.129263913824057', '0.084402430790007' UNION ALL
      SELECT '2016-01-25', '225', '0.0135135135135135', '14701', '4659', '0.470750223280738', '0.319707695820963' UNION ALL
      SELECT '2016-02-01', '236', '-0.078125', '14513', '4580', '0.0773159809683743', '0.075354609929078' UNION ALL
      SELECT '2016-02-08', '223', '-0.0785123966942148', '14942', '4700', '0.305354353074847', '0.215268530847758' UNION ALL
      SELECT '2016-02-15', '237', '-0.125461254612546', '14655', '4691', '0.129506475323766', '0.191456396635679' UNION ALL
      SELECT '2016-02-22', '255', '0.133333333333333', '14946', '4783', '0.0833276647847081', '0.133075767332045' UNION ALL
      SELECT '2016-02-29', '255', '0.0805084745762712', '14420', '4628', '-0.0320402397850205', '0.0524017467248905' UNION ALL
      SELECT '2016-03-07', '266', '0.192825112107623', '14917', '4780', '-0.00836568063177611', '0.0851063829787235' UNION ALL
      SELECT '2016-03-14', '252', '0.0632911392405062', '14350', '4619', '-0.104060047765267', '-0.0767426987849073' UNION ALL
      SELECT '2016-03-21', '245', '-0.0392156862745097', '14683', '4716', '-0.0879834069316204', '-0.0700397240225797' UNION ALL
      SELECT '2016-03-28', '257', '0.00784313725490193', '14748', '4745', '0.11373092926491', '0.126404494382021' UNION ALL
      SELECT '2016-04-04', '226', '-0.150375939849624', '14902', '4695', '-0.00502782060736062', '-0.0889121338912135' UNION ALL
      SELECT '2016-04-11', '241', '-0.0436507936507936', '14599', '4720', '0.0867595818815336', '0.109331024031175' UNION ALL
      SELECT '2016-04-18', '252', '0.0285714285714284', '14781', '4804', '0.0333719267179732', '0.0932994062765057' UNION ALL
      SELECT '2016-04-25', '241', '-0.0622568093385214', '15134', '4763', '0.130865202061296', '0.0189673340358276' UNION ALL
      SELECT '2016-05-02', '318', '0.407079646017699', '15352', '4880', '0.150986444772514', '0.197018104366347' UNION ALL
      SELECT '2016-05-09', '256', '0.0622406639004149', '14981', '4766', '0.130830878827317', '0.0487288135593222' UNION ALL
      SELECT '2016-05-16', '267', '0.0595238095238095', '15501', '4917', '0.243555916379135', '0.117610324729392' UNION ALL
      SELECT '2016-05-23', '253', '0.0497925311203319', '15921', '4898', '0.260010572221488', '0.14171740499685' UNION ALL
      SELECT '2016-05-30', '260', '-0.182389937106918', '15705', '4925', '0.114968733715477', '0.0461065573770491' UNION ALL
      SELECT '2016-06-06', '251', '-0.01953125', '15399', '4883', '0.13951004605834', '0.122744439781787' UNION ALL
      SELECT '2016-06-13', '276', '0.0337078651685394', '15954', '5050', '0.146119605186761', '0.135245068130974' UNION ALL
      SELECT '2016-06-20', '295', '0.166007905138339', '16129', '5032', '0.0653225299918347', '0.13679052674561' UNION ALL
      SELECT '2016-06-27', '266', '0.0230769230769229', '17284', '5314', '0.502706144539955', '0.39492385786802' UNION ALL
      SELECT '2016-07-04', '250', '-0.00398406374501991', '16902', '5220', '0.488018702513149', '0.345074749129633' UNION ALL
      SELECT '2016-07-11', '255', '-0.0760869565217391', '17583', '5435', '0.5105302745393', '0.381188118811881' UNION ALL
      SELECT '2016-07-18', '252', '-0.145762711864406', '17571', '5425', '0.447020894041788', '0.390500794912559' UNION ALL
      SELECT '2016-07-25', '273', '0.0263157894736842', '17985', '5512', '0.202788706317982', '0.186300338727888' UNION ALL
      SELECT '2016-08-01', '242', '-0.032', '17541', '5439', '0.189030883919062', '0.209770114942529' UNION ALL
      SELECT '2016-08-08', '304', '0.192156862745098', '18066', '5607', '0.137348575328442', '0.158233670653173' UNION ALL
      SELECT '2016-08-15', '239', '-0.0515873015873016', '17782', '5530', '0.0600421148483298', '0.0967741935483867' UNION ALL
      SELECT '2016-08-22', '287', '0.0512820512820513', '18140', '5625', '0.0430914651098135', '0.102503628447024' UNION ALL
      SELECT '2016-08-29', '256', '0.0578512396694215', '19251', '5895', '0.487429451000512', '0.41919470490899' UNION ALL
      SELECT '2016-09-05', '262', '-0.138157894736842', '19352', '5910', '0.355917192516328', '0.27019796682718' UNION ALL
      SELECT '2016-09-12', '269', '0.125523012552301', '19003', '5930', '0.343324710381284', '0.361663652802893' UNION ALL
      SELECT '2016-09-19', '270', '-0.0592334494773518', '20011', '6082', '0.515711135611907', '0.406222222222222' UNION ALL
      SELECT '2016-09-26', '287', '0.12109375', '19816', '6122', '0.146745623603968', '0.192536047497879' UNION ALL
      SELECT '2016-10-03', '259', '-0.0114503816793892', '20395', '6127', '0.269481190574617', '0.183587140439932'
       ;;
  }

  #     Define your dimensions and measures here, like this:
  dimension: orders_created_week {
    type: string
    sql: ${TABLE}.orders_created_week ;;
  }

  measure: orders_count {
    type: sum
    sql: ${TABLE}.orders_count ;;
  }

  measure: four_week_order_growth {
    type: sum
    sql: ${TABLE}.four_week_order_growth ;;
    value_format_name: percent_1
  }

  measure: events_count {
    type: sum
    sql: ${TABLE}.events_count ;;
  }

  measure: events_sessions_count {
    type: sum
    sql: ${TABLE}.events_sessions_count ;;
  }

  measure: four_week_event_growth {
    type: sum
    sql: ${TABLE}.four_week_event_growth ;;
    value_format_name: percent_1
  }

  measure: four_week_session_growth {
    type: sum
    sql: ${TABLE}.four_week_session_growth ;;
    value_format_name: percent_1
  }
}
